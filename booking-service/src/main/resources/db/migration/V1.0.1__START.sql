CREATE TABLE SHOWS (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    title VARCHAR(100) NOT NULL,
    location VARCHAR(255) NOT NULL,
    start_time TIMESTAMP NOT NULL,
    end_time TIMESTAMP NOT NULL
);

CREATE TABLE BOOKINGS (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email VARCHAR(255) NOT NULL UNIQUE,
    mobile VARCHAR(50) NOT NULL UNIQUE,
    show_id BIGINT,
    seat_count INT NOT NULL,
    status VARCHAR(30) NOT NULL,
    booking_time TIMESTAMP NOT NULL,
    CONSTRAINT fk_bookings_show FOREIGN KEY (show_id)
        REFERENCES SHOWS (id)
);

CREATE TABLE SEATS (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    seat_number VARCHAR(50) NOT NULL,
    show_id BIGINT NOT NULL,
    booked BOOLEAN NOT NULL DEFAULT FALSE,
    CONSTRAINT fk_seats_show FOREIGN KEY (show_id)
        REFERENCES SHOWS (id)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);

CREATE TABLE BOOKING_SEATS (
    booking_id BIGINT NOT NULL,
    seat_id BIGINT NOT NULL,
    PRIMARY KEY (booking_id, seat_id),
    CONSTRAINT fk_booking_seats_booking FOREIGN KEY (booking_id)
        REFERENCES BOOKINGS (id),
    CONSTRAINT fk_booking_seats_seat FOREIGN KEY (seat_id)
        REFERENCES SEATS (id)
);